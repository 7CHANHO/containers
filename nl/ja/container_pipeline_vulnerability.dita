<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task PUBLIC "-//IBM//DTD DITA IBM Task//EN"
 "ibm-task.dtd">
<task id="container_pipeline_vulnerability" xml:lang="ja-jp">
<title>(オプション) パイプラインの一部としてのイメージ・セキュリティーの検査</title>
<titlealts>
<navtitle>(オプション) イメージ・セキュリティーの検査</navtitle>
<searchtitle><keyword conref="cloudoeconrefs.dita#cloudoeconrefs/deliverypipeline"></keyword> と <keyword conref="cloudoeconrefs.dita#cloudoeconrefs/containershort"></keyword> を使用したイメージ・セキュリティーの検査</searchtitle></titlealts><abstract>
<shortdesc>コンテナーがデプロイされる前に、Vulnerability Advisor を使用してイメージ内のセキュリティーや構成の問題を見つけます。
</shortdesc></abstract>
<prolog>
<metadata>
<keywords><indexterm>イメージ</indexterm><indexterm>Vulnerability Advisor</indexterm><indexterm>セキュリティー</indexterm><indexterm>サービス</indexterm><indexterm>デリバリー・パイプライン</indexterm><indexterm>IBM Containers</indexterm><indexterm>コンテナー</indexterm><indexterm>パイプライン</indexterm><indexterm>継続的なデリバリー</indexterm></keywords></metadata></prolog>
<taskbody>
<context><p>このスキャンが含まれる一般的なパイプライン・セットアップは以下のとおりです。<ul>
<li>ソース・ファイルをビルドするビルド・ステージ</li>
<li>以下のジョブが含まれている処理ステージ:<ul>
<li>コンテナー・ビルドを実行するビルド・ジョブ</li>
<li>イメージに対して Vulnerability Advisor を実行するテスト・ジョブ</li></ul></li>
<li>コンテナーをデプロイするデプロイ・ステージ</li></ul></p>
<note type="tip">このタスクでは、コンテナー・イメージをビルドするジョブとは異なるステージで Vulnerability Advisor のテスト・ジョブを作成する方法の概略を説明します。
または、同じステージを使用することもできます。
別のステージを作成することにした場合は、環境変数を設定する必要はありません。</note></context>
<steps id="steps">
<stepsection>Vulnerability Advisor スキャンを作成します。</stepsection>
<step>
<cmd>処理ステージを作成します。</cmd><substeps>
<substep>
<cmd><uicontrol>「ステージの追加」</uicontrol>をクリックします。</cmd></substep>
<substep>
<cmd>ステージに名前を付けます。</cmd>
<stepxmp>例えば、<codeph><varname>Processing</varname></codeph> と指定します。</stepxmp></substep>
<substep>
<cmd>入力タイプとして<uicontrol>「ビルド成果物」</uicontrol>を選択します。</cmd></substep>
<substep>
<cmd>ステージとジョブの値を確認し、必要であれば更新します。
</cmd></substep>
<substep>
<cmd><uicontrol>「ジョブ」</uicontrol>タブをクリックします。</cmd></substep></substeps></step>
<step>
<cmd>この処理ステージに、コード・スキャンを実行するためのテスト・ジョブを追加します。</cmd><substeps>
<substep>
<cmd><uicontrol>「ジョブ」</uicontrol>タブで、<uicontrol>「ジョブの追加」</uicontrol>をクリックします。</cmd></substep>
<substep>
<cmd>ジョブ・タイプとして<uicontrol>「テスト」</uicontrol>を選択します。</cmd></substep>
<substep>
<cmd><uicontrol>「テスター・タイプ (Tester type)」</uicontrol>で<uicontrol>「IBM Vulnerability Advisor」</uicontrol>を選択します。</cmd></substep>
<substep>
<cmd>必要な場合、<keyword conref="cloudoeconrefs.dita#cloudoeconrefs/bluemix_short"></keyword> のターゲット、組織、およびスペースを更新します。
</cmd></substep>
<substep>
<cmd><uicontrol>「分析が完了するまで待機する分数 (Minutes to wait for analysis to complete)」</uicontrol>に 0 から 59 分の値を入力します。</cmd>
<info>デフォルト値は <varname>5</varname> 分です。
ジョブの最後に、コンソール・ログにダッシュボードへの URL が示されます。<p>この期間が終了するまでにスキャンが完了しなかった場合、ジョブは失敗しますが、スキャン分析は実行され続け、ダッシュボードで表示できます。スキャンの完了後に、ジョブを再実行した場合、スキャン要求は再実行依頼されず、パイプライン・ジョブは正常に完了できます。あるいは、スキャンが成功したらパイプラインがブロックされないように構成することができます。これについては、次のステップで説明します。</p></info></substep>
<substep>
<cmd>タイムアウト時の動作を決定するには、<uicontrol>「このジョブが失敗した場合、このステージの実行を停止する (Stop running this stage if this job fails)」</uicontrol>チェック・ボックスを選択するか、クリアします。</cmd>
<info>
<p>このジョブが失敗した場合にステージ内の後のジョブと後のステージの両方が実行されないようにブロックするようにジョブを構成できます。あるいは、後のジョブおよびステージをブロックせずに続行するようにステージを構成できます。ジョブの状態は、
主なセキュリティー問題の有無で判定されます。
</p>

<p>主なセキュリティー問題があると、ジョブが失敗します。
失敗したジョブがあった場合、<uicontrol>「このジョブが失敗した場合、このステージの実行を停止する (Stop running this stage if this job fails)」</uicontrol>での選択に応じて、ステージとパイプラインの処理が停止するか、または続行が許可されるかが決まります。
処理すべき問題がレポートに多数含まれていることが分かっている場合は、スキャンに長時間かかる可能性があるため、ステージを続行するように構成することをお勧めします。このシナリオでは、スキャンが長時間かかるという理由だけでは、ジョブおよびステージの残りを停止する必要がないことがあります。</p></info></substep></substeps></step>
<step>
<cmd>ジョブがビルド・ジョブと同じステージにある場合、リポジトリー名の環境変数を設定します。
</cmd><substeps>
<substep>
<cmd><uicontrol>「環境プロパティー」</uicontrol>タブをクリックします。</cmd></substep>
<substep>
<cmd><uicontrol>「プロパティーの追加」</uicontrol>をクリックし、<uicontrol>「文字プロパティー」</uicontrol>を選択します。</cmd></substep>
<substep>
<cmd><uicontrol>「名前」</uicontrol>フィールドで、<codeph>FULL_REPOSITORY_NAME</codeph> と入力します。</cmd></substep>
<substep>
<cmd><uicontrol>「値」</uicontrol>フィールドには、何も入力しないでください。</cmd>
<info>コンテナー・ビルド・ジョブに指定されたイメージ名がこの環境変数を通して渡されます。</info></substep></substeps></step>
<step>
<cmd><uicontrol>「保存」</uicontrol>をクリックします。</cmd></step>
<step>
<cmd><uicontrol>「ステージの実行」</uicontrol>アイコンをクリックして、ステージでエラーを出さずにビルドが行われることを確認します。</cmd><!--&lt;info audience="unknown"&gt;If the build failed, review the logs and correct the errors. For example, if you receive the following error,&lt;screen&gt;Minimum days that must elapse between user-initiated password changes should be 1. : PASS_MIN_DAYS must be set to 1&lt;/screen&gt; &lt;/info&gt;--></step></steps>
<result><p>Vulnerability Advisor スキャンの結果を表示するには、ジョブの完了後に<uicontrol>「結果およびヒストリーの表示 (View results and history)」</uicontrol>をクリックします。<uicontrol>「ログ」</uicontrol>タブで、以下のセクションを探してください。<msgblock>image registry.<keyword conref="cloudoeconrefs.dita#cloudoeconrefs/domainname"></keyword>/<varname>namespace</varname>/<varname>image</varname> vulnerability results found</msgblock></p>
<p>Vulnerability Advisor トピックの<xref href="va/va_index.html#va_reviewing" format="html" scope="peer">イメージ脆弱性の検討</xref>に記載されているように、脆弱パッケージ、セキュリティー問題、および推奨される改善の一覧がリストされます。
<xref href="va/va_index.html#va_report" format="html" scope="peer">イメージの問題の解決</xref>に、よく起きる問題を解決するための Dockerfile コードをいくつか記載しています。
</p><?tm 1435623327 1?></result></taskbody></task>
